---
title: 基于jdbc的策略模式
tag: 设计模式
---

## 基于jdbc的策略模式

>当进行数据库连接的时候，可能是mysql，可能是oracle,可能是pg,涉及到数据库的切换。为此采用策略模式进行多数据库切换，只需要选择不同数据库的对应的客户端就行
>
>策略模式原理：
>
>策略模式属于对象的行为模式。其用意是针对一组算法，将每一个算法封装到具有共同接口的独立的类中，从而使得它们可以相互替换。策略模式使得算法可以在不影响到客户端的情况下发生变化。
>
>缺点：把每个具体的策略实现都单独封装成为类，如果备选的策略很多的话，那么对象的数目就会很可观。

### 创建策略接口

```java
/**
 * <p>
 * 数据库连接策略接口
 * </p>
 */
public interface StatgeDb {
    public Connection getConnection();
}
```

### Mysql策略实现类

```java
/**
 * <p>
 * Mysql策略实现类
 * </p>
 */
public class MysqlStatge implements StatgeDb{
    /**
     * 具体实现
     * @return
     */
    @Override
    public Connection getConnection() {
        //1.加载驱动
        try {
            Class.forName("com.mysql.cj.jdbc.Driver");
        } catch (ClassNotFoundException e) {
            e.printStackTrace();
        }
        //2.获取连接
        Connection con = null;
        try {
            con = DriverManager.getConnection("jdbc:mysql://localhost:3306/switchgame(lf526)?characterEncoding=utf8&serverTimezone=UTC&useSSL=false", "root", "123456");

        } catch (SQLException throwables) {
            System.out.println("获取连接失败");
            throwables.printStackTrace();
        }
        System.out.println("获取连接成功");
        return con;
    }
}
```

### Orcale策略实现类

```java
/**
 * <p>
 * Orcale策略实现类
 * </p>
 */
public class OrcaleStatge implements StatgeDb{
    @Override
    public Connection getConnection() {
        System.out.println("OrcaleStatge连接成功，只做演示，不具体实现");
        return null;
    }
}
```

### Pg策略实现类

```java
/**
 * <p>
 * Pg策略实现类
 * </p>
 */
public class PgStatge implements StatgeDb{
    @Override
    public Connection getConnection() {
        System.out.println("PgStatge连接成功，只做演示，不具体实现");
        return null;
    }
}
```

### 策略模式实现类

>策略模式客户端，只需要创建客户端的时候，传入不同的策略对象，即可调用不同的数据库

```java
/**
 * <p>
 * 策略模式实现类
 * </p>
 */
public class StatgeDbClient {
    StatgeDb statgeDb;
    public StatgeDbClient(StatgeDb statgeDb){
        this.statgeDb = statgeDb;
    }
    public Connection getConnection(){
        return statgeDb.getConnection();
    }
}
```

### 策略模式实现测试类

```java
/**
 * <p>
 * 策略模式实现测试类
 * </p>
 */
public class StatgeDbTest {
    public static void main(String[] args) {
        //对mysql进行连接
        StatgeDbClient statgeDbClient = new StatgeDbClient(new MysqlStatge());
        Connection connection = statgeDbClient.getConnection();
        //对mysql进行连接
        StatgeDbClient orcaleStatge = new StatgeDbClient(new OrcaleStatge());
        Connection connection_orcale = orcaleStatge.getConnection();
        //对mysql进行连接
        StatgeDbClient pgStatge = new StatgeDbClient(new PgStatge());
        Connection connection_pgStatge = pgStatge.getConnection();
    }
}
```