---
title: 原型模式
tag: 设计模式
---

## 原型模式

>用一个已经创建的实例作为原型，通过复制该原型对象来创建一个和原型相同或相似的新对象。在这里，原型实例指定了要创建的对象的种类。

#### 优点：

>- Java自带的原型模式基于内存二进制流的复制，在性能上比直接 new 一个对象更加优良。
>- 可以使用深克隆方式保存对象的状态，使用原型模式将对象复制一份，并将其状态保存起来，简化了创建对象的过程，以便在需要的时候使用（例如恢复到历史某一状态），可辅助实现撤销操作。

#### 缺点:

>- 需要为每一个类都配置一个 clone 方法
>- clone 方法位于类的内部，当对已有类进行改造的时候，需要修改代码，违背了开闭原则。
>- 当实现深克隆时，需要编写较为复杂的代码，而且当对象之间存在多重嵌套引用时，为了实现深克隆，每一层对象对应的类都必须支持深克隆，实现起来会比较麻烦。因此，深克隆、浅克隆需要运用得当。

#### 抽象原型类

> Cloneable 接口

#### 具体原型类

>实现抽象原型类的 clone() 方法，它是可被复制的对象。

```java
/**
 * <p>
 * user类
 * </p>
 *
 */
public class User  implements Cloneable{
    Integer id;
    String username;
    String password;
    String salt;
    String ident;
    String telephone;
    String address;

    public User() {
    }

    public User(Integer id, String username, String password, String salt, String ident, String telephone, String address) {
        this.id = id;
        this.username = username;
        this.password = password;
        this.salt = salt;
        this.ident = ident;
        this.telephone = telephone;
        this.address = address;
    }

    public User(String username, String password, String salt, String ident, String telephone, String address) {
        this.username = username;
        this.password = password;
        this.salt = salt;
        this.ident = ident;
        this.telephone = telephone;
        this.address = address;
    }

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public String getUsername() {
        return username;
    }

    public void setUsername(String username) {
        this.username = username;
    }

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    public String getSalt() {
        return salt;
    }

    public void setSalt(String salt) {
        this.salt = salt;
    }

    public String getIdent() {
        return ident;
    }

    public void setIdent(String ident) {
        this.ident = ident;
    }

    public String getTelephone() {
        return telephone;
    }

    public void setTelephone(String telephone) {
        this.telephone = telephone;
    }

    public String getAddress() {
        return address;
    }

    public void setAddress(String address) {
        this.address = address;
    }

    @Override
    public String toString() {
        return "User{" +
                "id=" + id +
                ", username='" + username + '\'' +
                ", password='" + password + '\'' +
                ", salt='" + salt + '\'' +
                ", ident='" + ident + '\'' +
                ", telephone='" + telephone + '\'' +
                ", address='" + address + '\'' +
                '}';
    }

    public Object clone() throws CloneNotSupportedException {
        System.out.println("具体原型复制成功！");
        return (User) super.clone();
    }
}

```

测试方法

```java
/**
 * <p>
 * 原型测试类
 * </p>
 */
public class PrototypeTest {
    public static void main(String[] args) throws CloneNotSupportedException {
        User user = new User();
        User user1 = (User) user.clone();
        System.out.println("obj1==obj2?" + (user == user1));
    }
}
```

