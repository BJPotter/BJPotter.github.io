---
title: Elasticsearch
tag:
- Elasticsearch
typora-root-url: ./..
---



# 基础概念

## 什么是 Elasticsearch

Elasticsearch 是在 Apache Lucene 上构建的分布式、RESTful风格搜索和分析引擎，常用于日志分析、全文搜索、安全智能、业务分析和运维智能使用案例。

## Elasticsearch的核心功能

## 工作原理

Elasticsearch使用倒排索引来促进快速全文搜索，从而实现快速高效的数据访问。

### 倒排索引与正排索引区别

+ 概念概述

正排索引，全称为正向索引，是根据文档或者信息的ID等顺序，将相应的内容存储到索引中。它主要用于快速检索某个文档或者信息的内容。而倒排索引，全称为反向索引，则是根据文档或者信息中的某个关键词来查找存储该关键词的文档或者信息ID。这种索引方式主要用于关键词搜索。

+ 数据结构

正排索引的数据结构是B+树或者hash表，查询的时候只需要执行一次查找即可找到值，倒排索引的数据结构是倒排表，每次词对应一个倒排项，倒排项包含该词出现的文档编号，和词项在文中的位置信息。

+ 存储方式

正排索引，需要存储每个文档的完整的信息，如果存在多个文档，还需要建立一个文档池，将每个文档存储在一起，并在正向索引表中指向文档池中的相应位置。倒排索引不需要存储文档内容，只需存储关键字及其出现的文档和位置信息，存储内容较小，可以存储在内存中，提高查询效率。

+ 搜索效率

正排索引只需要查找一次就能找到相应的文档内容，倒排索引中，每个关键词可能对应多个文档，搜索速度方便不如正排索引。

+ 应用场景

正排索引适用于单个文档查找、内容显示如图书馆或档案的管理系统采用正排索引，倒排索引主要用于文本搜索、信息检索如搜索引擎中关键字查询，搜索引擎用倒排索引才检索与关键词相关的页面。

## 安装与配置

### 安装Elasticsearch

### 配置文件解析（elasticsearch.yml）

### 启动与验证

# 工作流程

## 数据提取

Elasticsearch 首先导入JSON 格式的数据，无论是直接输入还是通过 logstash 和 beats 等工具处理。

## 索引

它对这些数据进行索引，创建一个倒排索引，通过将术语链接到文档中的位置来实现快速文本搜索。

## 分片和复制

系统通过分片在节点之间分发数据，并通过复制增强容错能力和可用性。

## 搜索

查询 DSL（Domain Specific Language 特定领域语言） 允许用户执行搜索，访问倒排索引以快速找到相关文档。

## 分析和汇总

elasticsearch还可以进行数据分析和汇编，从而提供对趋势和模式的洞察。

## 结果检索

几乎实时地检索并返回查询结果。

<img src="/images/Elasticsearch.drawio.svg" style="zoom:67%;" />

# 基本操作

- 索引管理
  - 创建索引
  - 删除索引
  - 查看索引状态
- 文档管理
  - 增加文档
  - 获取文档
  - 更新文档
  - 删除文档
- 批量操作
  - 批量插入
  - 批量更新
  - 批量删除

# 查询与分析

- 查询DSL
  - 查询DSL简介
  - match查询
  - term查询
  - range查询
  - bool查询
- 过滤
  - filter的使用
  - 聚合
  - 常见聚合操作（如sum, avg, min, max等）

# 高级功能

- 分片与副本
  - 分片概念
  - 副本设置
  - 分片与副本管理
- 映射
  - 什么是映射
  - 动态映射
  - 静态映射
- 分析器
  - 内置分析器
  - 自定义分析器
  - 分词器的使用

# 集群管理

- 节点与集群
  - 单节点配置
  - 多节点集群配置
  - 集群健康检查
- 数据备份与恢复
  - 快照与恢复
  - 备份策略

# 安全性

- 安全配置
  - 用户认证
  - 角色与权限
- HTTPS配置
  - 安装证书
  - 配置HTTPS

# 性能优化

- 性能调优
  - JVM调优
  - 分片与副本优化
- 查询性能优化
  - 缓存策略
  - 查询重写

# 实战案例

- 全文搜索实现
  - 电商搜索引擎
  - 博客搜索功能
- 实时日志分析
  - Logstash与Elasticsearch结合
  - Kibana数据展示

# 扩展学习

- Elasticsearch生态系统
  - Logstash
  - Kibana
  - Beats
- 实时数据流处理
  - Elasticsearch与Kafka
  - Elasticsearch与Spark





