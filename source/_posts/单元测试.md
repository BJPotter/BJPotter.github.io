---
title: 什么是单元测试
tag:
- 单元测试
categorie:
- 单元测试
---



# 单元测试

单元测试（unit testing）是指对软件中的最小可测试单元进行检查和验证。它是软件测试的基础，通过单元测试可以确保每个单元模块按照预期的行为运行。以下是对单元测试的详细探讨，包括其定义、重要性、编写时机、细节要求以及相关概念。

## 什么是单元测试？

根据百度百科，单元测试是对软件中最小的可测试单元进行检查和验证。具体来说：

- **C语言**中的单元通常是一个函数。
- **Java**中的单元一般是一个类。
- 在图形化软件中，单元可以是一个窗口或一个菜单。

单元测试通常在软件开发过程中进行，测试单元与其他部分隔离，确保每个单元独立地按照预期功能工作。

## 为什么要写单元测试？

单元测试的优点：

1. **降低错误率**：通过编写单元测试，可以及早发现和修复代码中的错误，降低程序出错的概率。
2. **帮助代码重构**：单元测试允许在不破坏现有功能的情况下对代码进行重构。
3. **提高代码理解**：编写单元测试需要对代码的执行流程和预期结果有深入的理解。
4. **提供文档**：单元测试可以作为代码的活文档，展示函数或类的使用方式，并保持与代码同步。
5. **回归测试**：自动化的单元测试可以防止代码回归，提升测试效率，避免手动测试的低效和误差。
6. **持续集成**：通过集成到持续集成（CI）流程中，单元测试能确保每次代码提交后系统的稳定性。

## 什么时候写单元测试？

单元测试的编写时机有三种主要策略：

1. **测试驱动开发（TDD）**：在编写代码之前先编写测试用例，确保测试驱动开发流程。
2. **与实现同步**：在编写功能代码的同时，编写单元测试。此方法可确保测试覆盖率较高。
3. **事后编写**：功能代码开发完成后再编写测试。虽然可行，但测试粒度可能较粗，维护性较差。

**建议**：推荐在编写功能代码的同时进行单元测试，这样可以在开发过程中确保代码的正确性和可维护性。

## 单元测试要写多细？

单元测试的覆盖范围应根据以下标准来确定：

1. **逻辑复杂的**：功能逻辑复杂的部分需要细致的单元测试。
2. **容易出错的**：容易引发错误的代码段应有单元测试覆盖。
3. **不易理解的**：代码较难理解时，单元测试有助于文档化其功能。
4. **公共代码**：如工具类、拦截器等通用代码应有较高的覆盖率。
5. **核心业务代码**：业务核心模块的单元测试覆盖率应较高。

## 有哪些单元测试相关的概念？

### 被测系统 (System Under Test, SUT)

被测系统指正在测试的系统或组件，目的是验证其是否按预期运行。SUT可以是一个类、模块或整个系统。

### 测试依赖组件 (DOC)

被测系统依赖的组件，例如，在测试 `UserService` 时，`UserService` 可能依赖 `UserDao`，`UserDao` 就是 DOC。

### 测试替身 (Test Double)

测试替身是用来代替实际依赖对象的假对象，以简化测试过程。主要类型包括：

- **Test Stub**：提供数据的假对象。例如，模拟一个返回固定数据的HTTP接口。
- **Fake Object**：实现了简化功能的假对象。适用于不可用或运行缓慢的组件。
- **Mock Object**：用于验证方法调用是否符合预期的假对象，可以配置和追踪方法调用。
- **Dummy Object**：在测试中不使用的对象，仅为了使代码编译或运行正常。例如，传递不影响结果的参数。
- **Test Spy**：包装真实对象，并允许追踪方法调用。与Mock不同，Spy是在现有类的基础上创建的。

### Test Fixture

Test fixture 是进行测试所需的所有准备工作，包括测试数据、配置和依赖对象。在JUnit中，`@Before` 和 `@After` 用于在每个测试方法之前和之后执行初始化和清理工作。

### 测试用例 (Test Case)

测试用例是单个测试的基本单元。在JUnit 4及以后版本中，测试方法只需标注 `@Test` 注解，不再要求以 `test` 前缀命名。

### 测试套件 (Test Suite)

测试套件是将多个测试用例组合在一起的集合，用于批量运行测试。可以通过 `@RunWith` 和 `@SuiteClasses` 注解创建测试套件。

## 参考文章

- [CoolShell](https://coolshell.cn/articles/8209.html)
- [SegmentFault](https://segmentfault.com/a/1190000006731125)
- [CSDN](https://blog.csdn.net/flysqrlboy/article/details/79301241)
- [PDAI](https://pdai.tech/md/develop/ut/dev-ut-unit-test.html)

---

