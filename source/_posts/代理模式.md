---
title: 代理模式
tag: 设计模式
---

## 代理模式

>执行sql的时候想看下执行的sql语句，此时可以使用代理模式，把需要打印的sql，调用一下打印方法就可以了
>
>代理模式: 为一个对象提供一个替身，以控制对这个对象的访问。即通过代理对象访问目标对象.这样做的好处是:可以在目标对象实现的基础上,增强额外的功能操作,即扩展目标对象的功能。

### 创建代理模式接口

```java
/**
 * <p>
 * 代理模式接口
 * </p>
 */
public interface ProxySql {
    void print();
}
```

### 创建真实实现类

```java
/**
 * <p>
 * 代理真实类
 * </p>
 */
public class RealProxySqlImpl implements ProxySql{
    private String sql;
    public RealProxySqlImpl(String sql){
        this.sql = sql;
    }
    @Override
    public void print() {
        System.out.println("execute sql "+this.sql);
    }
}
```

### 创建代理实现类

```java
/**
 * <p>
 * 代理实现类
 * </p>
 */
public class ProxySqlImpl implements ProxySql{
    private RealProxySqlImpl realProxySql;
    private String sql;
    public ProxySqlImpl(String sql){
        this.sql = sql;
    }
    @Override
    public void print() {
        if(realProxySql == null){
            realProxySql = new RealProxySqlImpl(sql);
        }
        realProxySql.print();
    }
}
```

### 测试

>只需要需要打印sql的地方进行调用代理类，本方法打印sql实现比较简单，代理模式可以进行进行事务管理，sql注入的检测等其他高级功能

```java
//读取用户信息
public List<Map<String,String>>getUsers(String username){
 String sql = "select * from user";
 String[] params = null;
 if(username != null) {
  sql = sql + "where username like ?";
  //添加代理类
  ProxySql proxySql = new ProxySqlImpl(sql);
  proxySql.print();
  params = new String[] {"%"+ username + "%"};
}
 return db.getList(sql,params);
}
```

